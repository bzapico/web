<div id="apps-info-wrapper">
    <div class="modal-card">
      <div class="modal-content">
        <!-- Header -->
        <div class="modal-header">
          <h3 class="nalej-form-title">{{title}}</h3>
        </div>
        <!-- Body -->
        <div class="modal-body">
          <div *ngIf="loadedData">
            <!-- Service Graph -->
            <h3 class="services-title">Services</h3>
            <div class="graph">
              <div class="graph-click-fix"></div>
              <ngx-graph
                  class="chart-container"
                  [view]="view"
                  [legend]="showLegend"
                  [links]="graphData.links"
                  [nodes]="graphData.nodes"
                  [scheme]="colorScheme"
                  [orientation]="orientation"
                  [autoZoom]="autoZoom"
                  [autoCenter]="autoCenter"
                  [curve]="curve"
                  [enableZoom]="enableZoom">
                <ng-template #nodeTemplate let-node>
                  <svg:g class="node">
                    <svg:rect 
                    [attr.width]="node.width" 
                    [attr.height]="node.height" 
                    [attr.fill]="node.options.color" 
                    rx="14" 
                    ry="14"/>
                    <svg:text 
                      alignment-baseline="central" 
                      [attr.x]="10" 
                      [attr.y]="node.height / 2">
                      {{node.label}}
                  </svg:text>
                  </svg:g>
                </ng-template>
                <ng-template #linkTemplate let-link>
                  <svg:g class="edge">
                    <svg:path
                      class="line"
                      d="M 0,30 h100"
                      >
                    </svg:path>
                  </svg:g>
                </ng-template>
              </ngx-graph>
            </div>
            <!-- Deployed app table -->
            <div id="scrolltable" class="scrollable">
              <table class="table app-summary">
                <tr>
                  <td class="grey">Name</td>
                  <td class="text-right">{{instance.name}}</td>
                </tr>
                <tr>
                  <td class="grey">Status</td>
                  <td 
                    class="text-right" 
                    [ngClass]= 
                    "{'blue':instance.status_name === 'Running',
                    'red':instance.status_namee === 'Error'}">
                    {{instance.status_name}}
                  </td>
                </tr>
                <tr>
                  <td class="grey">Instance Id</td>
                  <td class="text-right">{{instance.app_instance_id}}</td>
                </tr>
                <tr>
                  <td class="grey">Descriptor Id</td>
                  <td class="text-right">{{instance.app_descriptor_id}}</td>
                </tr>
                <tr>
                  <td class="grey">Description</td>
                  <td class="text-right">{{instance.description}}</td>
                </tr>
                <tr>
                  <td class="grey" colspan="2">Configuration Options</td>
                  <td></td>
                </tr>
                <tr *ngFor="let option of objectToString(instance.configuration_options)">
                  <td class="text-right">{{option[0]}}</td>
                  <td class="text-right">{{option[1]}}</td>
                </tr>
                <tr>
                  <td class="grey" colspan="2">Environment Variables</td>
                  <td></td>
                </tr>
                <tr *ngFor="let variable of objectToString(instance.environment_variables)">
                  <td class="text-right">{{variable[0]}}</td>
                  <td class="text-right">{{variable[1]}}</td>
                </tr>
                <tr>
                  <td class="grey">Tags</td>
                  <td></td>
                </tr>
                <tr *ngFor="let label of objectToString(instance.labels)">
                  <td class="text-right">{{label[0]}}</td>
                  <td class="text-right">{{label[1]}}</td>
                </tr>


                <tr>
                  <td class="grey">Rules</td>              
                  <td></td>
                </tr>
                
                <tr *ngFor="let rule of instance.rules">
                  <td class="text-right">ID</td>
                  <td class="text-right">{{rule.rule_id}}</td>
                </tr>
                <tr *ngFor="let rule of instance.rules">
                  <td class="text-right">Name</td>
                  <td class="text-right">{{rule.name}}</td>
                </tr>
                <tr>
                  <td class="text-right">Service</td>
                  <div *ngFor="let rule of instance.rules">
                    <td class="d-block text-right" *ngFor="let service of rule.auth_services">{{service}}</td>
                  </div>
                </tr>


                <tr>
                  <td class="grey">Groups</td>              
                  <td></td>
                </tr>
                <tr *ngFor="let group of instance.groups">
                  <td class="text-right">Name</td>
                  <td class="text-right">{{group.name}}</td>
                </tr>
                <tr>
                  <td class="text-right">Service</td>
                  <div *ngFor="let group of instance.groups">
                    <td class="d-block text-right" *ngFor="let service of group.service_instances">{{service}}</td>
                  </div>
                </tr>
                <tr>
                  <td class="grey">Services</td>              
                  <td></td>
                </tr>
                <tr *ngFor="let service of instance.services">
                  <td class="text-right">ID</td>
                  <td class="text-right">{{service.service_id}}
                </tr>
                <tr *ngFor="let service of instance.services">
                  <td class="text-right">Name</td>
                  <td class="text-right">{{service.name}}
                </tr>
                <tr *ngFor="let service of instance.services">
                  <td class="text-right">Status</td>
                  <td class="text-right"> {{service.status_name}}
                </tr>
              </table>
            </div>
          </div> 
          <!-- Loader -->           
          <div class="nalej-loader-container" *ngIf="!loadedData">
            <div class="loader">
              <svg 
                class="circular" 
                viewBox="25 25 50 50">
                <circle 
                  class="path" 
                  cx="50" 
                  cy="50" 
                  r="20" 
                  fill="none" 
                  stroke-width="2" 
                  stroke-miterlimit="10"/>
              </svg>
            </div>
          </div>
          <!-- Option button -->
          <div class="buttons d-flex flex-row justify-content-center">
            <button class="btn btn-primary btn-lg" (click)="bsModalRef.hide()">
              <span class="align-bottom">Close</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  