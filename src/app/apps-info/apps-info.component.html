<div id="apps-info-wrapper">
    <div class="modal-card">
      <div class="modal-content">
        <!-- Header -->
        <div class="modal-header">
          <h3 class="nalej-form-title">{{title}}</h3>
        </div>
        <!-- Body -->
        <div class="modal-body">
          <div *ngIf="loadedData">
            <!-- Service Graph -->
            <h3 class="services-title">Services</h3>
            <div class="graph">
              <div class="graph-click-fix"></div>
              <ngx-graph
                  class="chart-container ml-4"
                  [view]="view"
                  [legend]="showLegend"
                  [links]="graphData.links"
                  [nodes]="graphData.nodes"
                  [scheme]="colorScheme"
                  [orientation]="orientation"
                  [autoZoom]="autoZoom"
                  [autoCenter]="autoCenter"
                  [curve]="curve"
                  [enableZoom]="enableZoom">
                <ng-template #nodeTemplate let-node>
                  <svg:g class="node">
                    <svg:rect 
                    [attr.width]="node.width" 
                    [attr.height]="node.height" 
                    [attr.fill]="node.options.color" 
                    rx="14" 
                    ry="14"/>
                    <svg:text 
                      alignment-baseline="central" 
                      [attr.x]="10" 
                      [attr.y]="node.height / 2">
                      {{node.label}}
                  </svg:text>
                  </svg:g>
                </ng-template>
                <ng-template #linkTemplate let-link>
                  <svg:g class="edge">
                    <svg:path
                      stroke-width="2"
                      class="line"
                      d="M 0,30 h100"
                      >
                    </svg:path>
                  </svg:g>
        d        </ng-template>
              </ngx-graph>
            </div>
            <!-- Deployed app info grid -->
            <div id="scroll-app-info">
              <div class="row">
                <div class="col-sm grey">Name</div>
                <div class="col-sm text-right">{{instance.name}}</div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Status</div>
                <div class="col-sm text-right text-lowercase" [ngClass]= 
                  "{'blue':instance.status_name === 'Running',
                  'red':instance.status_namee === 'Error'}">{{instance.status_name}}
                </div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Instance id</div>
                <div class="col-sm text-right">{{instance.app_instance_id}}</div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Descriptor id</div>
                <div class="col-sm text-right">{{instance.app_descriptor_id}}</div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Tags</div>
              </div>
              <div class="row" *ngFor="let label of objectToString(instance.labels)">
                <div class="col-sm text-right">{{label[0]}}</div>
                <div class="col-sm text-right">{{label[1]}}</div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Configuration options</div>
              </div>
              <div class="row" *ngFor="let option of objectToString(instance.configuration_options)">
                <div class="col-sm text-right">{{option[0]}}</div>
                <div class="col-sm text-right">{{option[1]}}</div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Environment variables</div>
              </div>
              <div class="row" *ngFor="let variable of objectToString(instance.environment_variables)">
                <div class="col-sm text-right">
                  {{variable[0]}}
                </div>
                <div class="col-sm text-right">
                  {{variable[1]}}
                </div>
              </div>
              <br>
              <div class="row">
                <div class="col-sm grey">Services</div>
              </div>
              <div *ngFor="let service of instance.services">
                <div class="row">
                  <div class="col-sm text-right grey">Name</div>
                  <div class="col-sm text-right">{{service.name}}</div>
                </div>
                <div class="row">
                  <div class="col-sm text-right grey">Id</div>
                  <div class="col-sm text-right">{{service.service_id}}</div>
                </div>
                <div class="row">
                  <div class="col-sm text-right grey">Status</div>
                  <div class="col-sm text-right text-lowercase" [ngClass]= 
                  "{'blue':instance.status_name === 'Running',
                  'red':instance.status_namee === 'Error'}"> 
                  {{service.status_name}}</div>
                </div>
                <br>
              </div>
              <div class="row">
                <div class="col-sm grey">Rules</div>
              </div>
              <div *ngFor="let rule of instance.rules">
                <div class="row">
                  <div class="col-sm text-right grey">Name</div>
                  <div class="col-sm text-right">{{rule.name}}</div>
                </div>
                <div class="row">
                  <div class="col-sm text-right grey">Id</div>
                  <div class="col-sm text-right">{{rule.rule_id}}</div>
                </div>
                <div class="row" *ngFor="let relation of rule.auth_services; let i = index">
                  <div *ngIf="i === 0" class="col-sm text-right grey" >Relations</div>
                  <div *ngIf="i !== 0" class="col-sm"></div>
                  <div class="col-sm text-right">{{relation}}</div>
                </div>
                <br>
              </div>
              <div class="row">
                <div class="col-sm grey">Groups</div>
              </div>
              <div *ngIf="!instance.groups || instance.groups.length === 0" class="row">
                <div class="col-sm text-right grey">-</div>
                <div class="col-sm text-right">-</div>
              </div>
              <div *ngFor="let group of instance.groups">
                <div class="row">
                  <div class="col-sm text-right grey">Name</div>
                  <div class="col-sm text-right">{{group.name}}</div>
                </div>
                <div class="row" *ngFor="let service of group.service_instances; let i = index">
                  <div *ngIf="i === 0" class="col-sm text-right grey" >Services</div>
                  <div *ngIf="i !== 0" class="col-sm"></div>
                  <div class="col-sm text-right">{{service}}</div>
                  <br>
                </div>
              </div>    
            </div>     
          <div> 
          <!-- Loader -->           
          <div class="nalej-loader-container" *ngIf="!loadedData">
            <div class="loader">
              <svg 
                class="circular" 
                viewBox="25 25 50 50">
                <circle 
                  class="path" 
                  cx="50" 
                  cy="50" 
                  r="20" 
                  fill="none" 
                  stroke-width="2" 
                  stroke-miterlimit="10"/>
              </svg>
            </div>
          </div>
          <!-- Option button -->
          <div class="buttons d-flex flex-row justify-content-center">
            <button class="btn btn-primary btn-lg" (click)="bsModalRef.hide()">
              <span class="align-bottom">Close</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  