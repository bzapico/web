<!-- Application instances id card -->
<div class="card">
  <div class="card-title-name">
    <h5 *ngIf="openFromInstance" class="d-inline">{{'app-info.instance.title'|translate}}</h5>
    <h5 *ngIf="openFromRegistered" class="d-inline">{{'app-info.registered.title'|translate}}</h5>
    <div
      *ngIf="openFromInstance"
      tooltip="Info" 
      placement="left"
      (click)="openAppInfoDetailed(instance)"
      class="app-info-button">
      <i class="material-icons info-icon">info</i>
    </div>
    <div
      *ngIf="openFromRegistered"
      tooltip="Info" 
      placement="left"
      (click)="openDescriptorDetailed(registeredData)"
      class="app-info-button">
      <i class="material-icons info-icon">info</i>
    </div>
  </div>
  <div class="summary-instance-card">
    <!-- Summary instances table-->
    <div class="summary-table">
      <div class="summary-table-tr">
        <div class="summary-table-th">{{'devices.tableName'|translate}}</div>
        <div *ngIf="openFromInstance" class="text-uppercase summary-table-td">{{instance.name}}</div> 
        <div *ngIf="openFromRegistered" class="text-uppercase summary-table-td-big">{{registeredData.name}}</div> 
      </div>
      <div *ngIf="openFromInstance" class="summary-table-tr">
        <div class="summary-table-th">{{'devices.tableStatus'|translate}}</div> 
        <div id="summary-status" class="summary-table-td">
          <span 
            *ngIf="instance && instance.status_name"
            [ngClass]=
              "{
                'big-status-dot':classInstanceStatusCheck(instance.status_name, 'status.running'|translate),
                'big-status-dot-error':classInstanceStatusCheck(instance.status_name, 'status.error'|translate),
                'big-status-dot-process':classInstanceStatusCheck(instance.status_name, 'status.process'|translate)
              }"
            tooltip="{{instance.status_name}}" 
            placement="bottom"
            class="big-status-dot">
            {{instance.status_name}}
          </span>
        </div>
      </div>
      <div *ngIf="openFromInstance" class="summary-table-tr">
        <div class="summary-table-th">{{'apps.instance.tableInstanceOf'|translate}}</div>
        <!-- GET REGISTERED AND SET THE RIGHT NAME --> 
        <div class="summary-table-td">
          <a 
            [routerLink]="['/applications/registered', instance.app_descriptor_id]" 
            routerLinkActive="active" 
            class="blue">
            {{getDescriptorName(instance.app_descriptor_id)}}
          </a>
        </div>
      </div>
    </div>
    <!-- Summary tabs -->
    <div class="summary-info-box">
      <ul class="tabs-box">
        <li 
          (click)="changeActiveList('parameters')" 
          [ngClass]=
            "{
              'active': showParameters && !showNetwork && !showSetup,
              'tabs-btn-selected': showParameters && !showNetwork && !showSetup
            }" 
          class="tabs-btn">
          {{'app-info.tabs.parameters'|translate}}
        </li>
        <li 
          (click)="changeActiveList('network')" 
          [ngClass]=
            "{
              'active': showNetwork && !showParameters && !showSetup,
              'tabs-btn-selected': showNetwork && !showParameters && !showSetup
            }" 
          class="tabs-btn">
            {{'app-info.tabs.networks'|translate}}
        </li>
        <li 
          (click)="changeActiveList('setup')" 
          [ngClass]=
            "{
              'active': showSetup && !showParameters && !showNetwork ,
              'tabs-btn-selected': showSetup && !showParameters && !showNetwork 
            }" 
          class="tabs-btn">
            {{'app-info.tabs.setup'|translate}}
        </li>
      </ul>
    </div>
    <!-- Search box -->
    <div class="summary-info-box">
      <div class="search-box">
        <input 
          name="searchTerm" 
          [(ngModel)]="searchTerm"
          type="text" 
          placeholder="{{'searcher.placeholder'|translate }}"
          class="form-control"> 
        <div *ngIf="searchTerm === ''" class="search-icon">
          <i class="material-icons">search</i>
        </div>     
        <div *ngIf="searchTerm !== ''" class="close-icon">
          <i (click)="resetFilters()" class="material-icons">close</i>
        </div>
      </div>
    </div>
    <!-- List to show box -->
    <div class="summary-info-box">
      <!-- Parameters list -->
      <div *ngIf="showParameters" class="summary-parameters">
        <!-- Basic Parameters list -->
        <div class="accordion-box">
          <accordion 
            class="accordion-tabs">
            <accordion-group 
              heading="Basic"
              [panelClass]="nalejAccordionSmall"
              [isOpen]="isFirstOpen">
              <span     
                accordion-heading 
                class="accordion-icons-box">
                <i class="material-icons accordion-arrow">arrow_drop_down</i>
              </span>
              <div class="form-group">
                <div>
                  <label>param 1</label>
                  <input 
                    type="text" 
                    placeholder="Default value"
                    class="form-control"
                    disabled>
                  <label class="accordion-foot">{{'app-info.typeRestrictions'|translate}}</label>
                </div>
                <div>
                  <label>param 1</label>
                  <input 
                    type="text" 
                    placeholder="Default value"
                    class="form-control"
                    disabled>
                  <label class="accordion-foot">{{'app-info.typeRestrictions'|translate}}</label>
                </div>
              </div>
            </accordion-group>
          </accordion>
        </div>
        <!-- Advanced Parameters list -->
        <div class="accordion-box">
          <accordion 
            class="accordion-tabs">
            <accordion-group 
              heading="Advanced"
              [panelClass]="nalejAccordionSmall"
              [isOpen]="isFirstOpen">
              <span     
                accordion-heading 
                class="accordion-icons-box">
                <i class="material-icons accordion-arrow">arrow_drop_down</i>
              </span>
              <div class="form-group">
                <div>
                  <label>param 1</label>
                  <input 
                    type="text" 
                    placeholder="Default value"
                    class="form-control"
                    disabled>
                  <label class="accordion-foot">{{'app-info.typeRestrictions'|translate}}</label>
                </div>
                <div>
                  <label>param 1</label>
                  <input 
                    type="text" 
                    placeholder="Default value"
                    class="form-control"
                    disabled>
                  <label class="accordion-foot">{{'app-info.typeRestrictions'|translate}}</label>
                </div>
              </div>
            </accordion-group>
          </accordion>
        </div>
      </div>
      <!-- Networks list -->
      <div *ngIf="showNetwork" class="summary-network">
        <div class="accordion-box accordion-box-small">
          <accordion 
            class="accordion-tabs">
            <accordion-group 
              heading="Inbounds"
              [panelClass]="nalejAccordionSmall"
              [isOpen]="isFirstOpen">
              <span     
                accordion-heading 
                class="accordion-icons-box">
                <i class="material-icons accordion-arrow">arrow_drop_down</i>
              </span>
              <!-- INSTANCE INFO network-inbounds -->
              <div *ngIf="openFromInstance" class="label-nalej-table no-m-row">
                <div class="label-thead row">
                  <div class="col-4 label-th">
                    <span tooltip="Interface" placement="bottom">
                      {{'app-info.instance.NetworkInterface'|translate}}
                    </span>
                  </div>
                  <div class="col-4 label-th text-center">
                    <span tooltip="Source" placement="bottom">
                      {{'app-info.instance.NetworkSource'|translate}}
                    </span>
                  </div>
                  <div class="col-4 label-th text-right">
                    <span tooltip="Disconnect" placement="bottom">
                      {{'app-info.instance.NetworkDisconnect'|translate}}
                    </span>
                  </div>
                </div>
                <div class="scroll-app-info">
                  <div *ngFor=
                    "let connection of copyConnections |
                    filter : searchTerm; let i = index">
                    <span *ngIf="connection.connected" class="label-tbody row">
                      <div class="col-4">
                        <span class="grey">{{connection.inbound.interfaceName}}</span>
                      </div>
                      <div class="col-4 text-center">
                        <span>{{connection.inbound.instance}}</span>
                        <br>
                        <span>{{connection.outbound.interfaceName}}</span>
                      </div>
                      <div class="col-4 text-right px-4">
                        <button 
                          (click)="disconnectInstance(connection)"
                          tooltip="{{'apps.manageConnections.disconnect'|translate}}" 
                          placement="left" 
                          class="action-btn-red">
                          <i class="material-icons i-red">link_off</i>
                        </button>
                      </div>
                    </span>
                  </div>
                </div>
              </div>
              <!-- DESCRIPTOR INFO network-inbounds-->
              <div *ngIf="openFromRegistered" class="label-nalej-table no-m-row">
                <div class="scroll-app-info">
                  <div *ngFor=
                    "let connection of copyConnections |
                    filter : searchTerm; let i = index">
                    <span *ngIf="connection.connected" class="label-tbody row">
                      <div class="col-6">
                        <span class="grey">{{connection.inbound.interfaceName}}</span>
                      </div>
                      <div class="col-6 text-right">
                        <span>{{connection.inbound.instance}}</span>
                        <br>
                        <span>{{connection.outbound.interfaceName}}</span>
                      </div>
                    </span>
                  </div>
                </div>
              </div>
            </accordion-group>
          </accordion>
        </div>
        <div class=" accordion-box accordion-box-small">
          <accordion 
          class="accordion-tabs">
          <accordion-group 
            heading="Outbound"
            [panelClass]="nalejAccordionSmall"
            [isOpen]="isFirstOpen">
            <span     
              accordion-heading 
              class="accordion-icons-box">
              <i class="material-icons accordion-arrow">arrow_drop_down</i>
            </span>
            <span     
              accordion-heading 
              class="accordion-legend">
              <p>{{'app-info.requiredElements'|translate}}</p>
            </span>
            <!-- INSTANCE INFO network-outbounds -->
            <div *ngIf="openFromInstance" class="label-nalej-table no-m-row">
              <div class="label-thead row">
                <div class="col-4 label-th">
                  <span tooltip="Interface" placement="bottom">
                    {{'app-info.instance.NetworkInterface'|translate}}
                  </span>
                </div>
                <div class="col-4 label-th text-center">
                  <span tooltip="Target" placement="bottom">
                    {{'app-info.instance.NetworkTarget'|translate}}
                  </span>
                </div>
                <div class="col-4 label-th text-right">
                  <span tooltip="Disconnect" placement="bottom">
                    {{'app-info.instance.NetworkDisconnect'|translate}}
                  </span>
                </div>
              </div>
              <div class="scroll-app-info">
                <div *ngFor=
                  "let connection of copyConnections |
                  filter : searchTerm; let i = index">
                  <span *ngIf="connection.connected" class="label-tbody row">
                    <div class="col-4">
                      <span class="grey">{{connection.outbound.interfaceName}}</span>
                    </div>
                    <div class="col-4 text-center">
                      <span>{{connection.inbound.instance}}</span>
                      <br>
                      <span>{{connection.inbound.interfaceName}}</span>
                    </div>
                    <div class="col-4 text-right px-4">
                      <button 
                        (click)="disconnectInstance(connection)"
                        tooltip="{{'apps.manageConnections.disconnect'|translate}}" 
                        placement="left" 
                        class="action-btn-red">
                        <i class="material-icons i-red">link_off</i>
                      </button>
                    </div>
                  </span>
                </div>
              </div>
            </div>
            <!-- REGISTERED INFO network-outbounds -->
            <div *ngIf="openFromRegistered" class="label-nalej-table  no-m-row">
              <div class="scroll-app-info">
                <div *ngFor=
                  "let connection of copyConnections |
                  filter : searchTerm; let i = index">
                  <span *ngIf="connection.connected" class="label-tbody row">
                    <div class="col-6">
                      <span class="grey">{{connection.outbound.interfaceName}}</span>
                    </div>
                    <div class="col-6 text-right">
                      <span>{{connection.inbound.instance}}</span>
                      <br>
                      <span>{{connection.inbound.interfaceName}}</span>
                    </div>
                  </span>
                </div>
              </div>
            </div>
          </accordion-group>
          </accordion>
        </div>
      </div>
      <!-- Setup list -->
      <div *ngIf="showSetup" class="summary-parameters">
        <!-- Environment variables list -->
        <div class="accordion-box">
          <accordion 
            class="accordion-tabs">
            <accordion-group 
              heading="{{'apps.instance.environmentVariables'|translate}}"
              [panelClass]="nalejAccordionSmall"
              [isOpen]="isFirstOpen">
              <span     
                accordion-heading 
                class="accordion-icons-box">
                <i class="material-icons accordion-arrow">arrow_drop_down</i>
              </span>
              <div class="label-nalej-table no-p-col no-m-row">
                <!-- REGISTERED INFO Environment variables -->
                <div *ngIf="openFromRegistered" class="scroll-app-info">
                  <div *ngIf="registeredData.environment_variables">
                    <div *ngFor="let variable of registeredData.environment_variables | keyvalue" class="row label-tbody">
                      <div class="col-6 grey">
                        {{variable.key}} 
                      </div>
                      <div class="col-6 text-right">
                        {{variable.value}}
                      </div>
                    </div>
                  </div>
                  <div *ngIf="!registeredData.environment_variables">
                    <p class="grey">{{'apps.instance.noEnvironmentVariables'|translate}}</p>
                  </div>
                </div>
                <!-- INSTANCE INFO Environment variables -->
                <div *ngIf="openFromInstance" class="scroll-app-info">
                  <div *ngIf="instance.environment_variables">
                    <div *ngFor="let variable of instance.environment_variables | keyvalue" class="row label-tbody">
                      <div class="col-6 grey">
                        {{variable.key}} 
                      </div>
                      <div class="col-6 text-right">
                        {{variable.value}}
                      </div>
                    </div>
                  </div>
                  <div *ngIf="!instance.environment_variables">
                    <p class="grey">{{'apps.instance.noEnvironmentVariables'|translate}}</p>
                  </div>
                </div>
              </div>
            </accordion-group>
          </accordion>
        </div>
        <!-- Other setting  list -->
        <div class="accordion-box">
          <accordion 
            class="accordion-tabs">
            <accordion-group 
              heading="{{'apps.instance.otherSettings'|translate}}"
              [panelClass]="nalejAccordionSmall"
              [isOpen]="isFirstOpen">
              <span     
                accordion-heading 
                class="accordion-icons-box">
                <i class="material-icons accordion-arrow">arrow_drop_down</i>
              </span>
              <div class="label-nalej-table no-p-col no-m-row">
                <!-- REGISTERED INFO Other setting -->
                <div *ngIf="openFromRegistered" class="scroll-app-info">
                  <div *ngIf="registeredData.configuration_options">
                    <p class="text-left">{{'apps.instance.otherSettings'|translate}}</p>
                    <div *ngFor="let configuration of registeredData.configuration_options| keyvalue" class="row mb-1">
                      <div class="col-12 grey text-right">
                        {{configuration.key}} 
                      </div>
                      <div class="col-12 text-right">
                        {{configuration.value}}
                      </div>
                    </div>
                  </div>
                  <div *ngIf="!registeredData.configuration_options">
                    <p class="grey">{{'apps.instance.noOtherSettings'|translate}}</p>
                  </div>
                </div>
                <!-- INSTANCE INFO Other setting -->
                <div *ngIf="openFromInstance" class="scroll-app-info">
                  <div *ngIf="instance.configuration_options">
                    <p class="text-left">{{'apps.instance.otherSettings'|translate}}</p>
                    <div *ngFor="let configuration of instance.configuration_options| keyvalue" class="row mb-1" >
                      <div class="col-12 grey text-right">
                        {{configuration.key}} 
                      </div>
                      <div class="col-12 text-right">
                        {{configuration.value}}
                      </div>
                    </div>
                  </div>
                  <div *ngIf="!instance.configuration_options">
                    <p class="grey">{{'apps.instance.noOtherSettings'|translate}}</p>
                  </div>
                </div>
              </div>
            </accordion-group>
          </accordion>
        </div>
      </div>
    </div>
  </div>
</div>
