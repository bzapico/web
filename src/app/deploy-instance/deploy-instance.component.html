<div class="modal-card">
    <div class="modal-content">
      <!-- Header -->
      <div class="modal-header">
        <h3 class="nalej-form-title">Deploy instance</h3>
        <button 
          (click)="discardChanges(f)"
          type="button" 
          aria-label="Close"
          class="close" >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    </div>
    <!-- Body -->
    <div class="modal-body">
      <div *ngIf="loadedData">
        <form [formGroup]="deployInstanceForm" (ngSubmit)="deployInstance(f)">
          <div class="scroll-modal-form">
            <div *ngIf="!openFromRegistered" class="form-group form-group-drop">
              <label>Registered name</label>
              <ngx-select-dropdown 
                formControlName="selectDrop" 
                [multiple]="false" 
                [config]="selectConfig" 
                [options]="registeredApps"
                (change)="onRegisteredChange(f)"
                [ngClass]="{ 'base-light-grey': !f.selectDrop.value }">
              </ngx-select-dropdown>
              <div class="form-group-drop-arrow"> 
                <i class="material-icons">arrow_drop_down</i>
              </div>
              <div class="error-h"></div>
            </div>
            <div *ngIf="openFromRegistered" class="form-group">
              <label>Registered name</label>
              <input 
                formControlName="registeredName" 
                type="text" 
                placeholder="{{registeredName}}"
                class="form-control">
              <div class="error-h"></div>
            </div>
            <div class="form-group">
              <label>Instance name*</label>
              <input 
                formControlName="instanceName" 
                type="text" 
                value="instanceName"
                placeholder="Instance name"
                appAutofocus="{{defaultAutofocus}}"
                [ngClass]="{ 'is-invalid': submitted && f.instanceName.errors }"
                class="form-control">
              <div class="error-h">
                <div *ngIf="submitted && f.instanceName.errors" class="error-message">
                  <div *ngIf="f.instanceName.errors.required">Name is required</div>
                  <div *ngIf="f.instanceName.errors.minlength">Name is too short</div>
                  <div *ngIf="f.instanceName.errors.pattern">Cannot contain special characters</div>
                </div>
              </div>
            </div>
            <div *ngIf="selectedApp && availableParamsCategory.basic" class="form-group">
              <label>Parameters</label>
              <!-- DEFAULT PARAMETERS -->
              <div class="accordion">
                <div class="accordion-header" (click)="toggleDefaultParameters()">Default</div>
                <div 
                  *ngIf="defaultParamsOpened"
                  class="accordion-body">
                  <div 
                    *ngFor="let param of selectedApp.parameters"
                    class="form-group">
                    <div *ngIf="!param.category || param.category==='BASIC'">
                      <label>{{param.name}}</label>
                      <input 
                        type="text" 
                        placeholder="{{param.name}}"
                        class="form-control"
                        value="{{param.value}}"
                        (input)="param.value = $event.target.value"
                        >
                      <label class="accordion-foot">Type restrictions: {{param.type}}</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="accordion" *ngIf="selectedApp && availableParamsCategory.advanced" >
                  <div class="accordion-header" (click)="toggleAdvancedParameters()">Advanced</div>
                  <div 
                    *ngIf="advParamsOpened"
                    class="accordion-body">
                    <div 
                      *ngFor="let param of selectedApp.parameters"
                      class="form-group">
                      <div *ngIf="param.category==='ADVANCED'">
                        <label>{{param.name}}</label>
                        <input 
                          type="text" 
                          placeholder="{{param.name}}"
                          class="form-control"
                          value="{{param.value}}"
                          (input)="param.value = $event.target.value"
                          >
                        <label class="accordion-foot">Type restrictions: {{param.type}}</label>
                      </div>
                    </div>
                  </div>
                </div>
              <!-- ADVANCED PARAMETERS-->
            </div>
          </div>
        </form>
        <div class="form-group-btn">
          <button class="nalej-form-btn-blue" (click)="deployInstance(f)" [disabled]="loading">
            <span class="align-bottom">Deploy</span>
          </button>
        </div>
      </div>
      <!-- Loader -->
      <div *ngIf="!loadedData" class="nalej-loader-box">
        <div class="loader">
          <svg class="circular" viewBox="25 25 50 50">
            <circle 
            class="path" 
            cx="50" 
            cy="50" 
            r="20" 
            fill="none" 
            stroke-width="2" 
            stroke-miterlimit="10"/>
          </svg>
        </div>
      </div>
    </div>
  </div>